*       *********************************************************
*       *                                                         
*       * 22/06/2023          CONTEXTMENU.MPR           19:53:33  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Daniel Adamiak                                          
*       *                                                         
*       * Copyright (C) 2023 Dev_Print                            
*       * dgadamiak@gmail.com                                     
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

DEFINE POPUP shortcut SHORTCUT RELATIVE FROM MROW(),MCOL()
DEFINE BAR 1 OF shortcut PROMPT "Utwórz wydanie na podstawie tej pozycji" ;
	KEY ALT+W, "ALT+W"
ON SELECTION BAR 1 OF shortcut ;
	DO _6na16mxfc ;
	IN LOCFILE("SIMPLE_WMS\FORMS\CONTEXTMENU" ,"MPX;MPR|FXP;PRG" ,"WHERE is CONTEXTMENU?")

ACTIVATE POPUP shortcut

*       *********************************************************
*       *                                                         
*       * _6NA16MXFC  ON SELECTION BAR 1 OF POPUP shortcut        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  CONTEXTMENU.MPR,            Record:    5    
*       * Called By:  ON SELECTION BAR 1 OF POPUP shortcut        
*       * Prompt:     Utwórz wydanie na podstawie tej pozycji     
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6na16mxfc
Do progs/load_cursor with '_main'
Select a_main
If Used('a_main')
	thisform.currpos = Recno('a_main')
EndIf

Select * from a_main where a_main.name_id = materials_counter.m_id AND a_main.u_type_id = materials_counter.utype_id and a_main.p_type_id = materials_counter.ptype_id and ;
	a_main.project_id = materials_counter.p_id and a_main.client_id = materials_counter.c_id into cursor i_tmp readwrite

Select * from i_tmp where Recno() = Reccount() into cursor i_tmp readwrite

Select i_tmp
replace i_tmp.unit_qty with materials_counter.current_quantity
replace i_tmp.pack_qty with materials_counter.curr_pack_qty
replace i_tmp.pallet_qty with materials_counter.current_pallets_qty
replace i_tmp.file1 with '', i_tmp.file2 with '', i_tmp.file3 with ''

DO FORM 'Forms\in_add.scx' NAME MyFrm with '', 0

Select a_main
thisform.set_filter_to_grid()

Select i_tmp
Use

If Used('a_main')
	Select a_main
	Use
EndIf


